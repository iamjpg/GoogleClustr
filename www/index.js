var gt=Object.create;var G=Object.defineProperty;var pt=Object.getOwnPropertyDescriptor;var dt=Object.getOwnPropertyNames;var mt=Object.getPrototypeOf,vt=Object.prototype.hasOwnProperty;var M=(e,r)=>()=>(e&&(r=e(e=0)),r);var P=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),yt=(e,r)=>{for(var t in r)G(e,t,{get:r[t],enumerable:!0})},be=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of dt(r))!vt.call(e,o)&&o!==t&&G(e,o,{get:()=>r[o],enumerable:!(n=pt(r,o))||n.enumerable});return e};var H=(e,r,t)=>(t=e!=null?gt(mt(e)):{},be(r||!e||!e.__esModule?G(t,"default",{value:e,enumerable:!0}):t,e)),bt=e=>be(G({},"__esModule",{value:!0}),e);var ke=P((gr,Le)=>{"use strict";function U(e){this.map=e}U.prototype=new google.maps.OverlayView;U.prototype.onRemove=function(){this.div.parentNode.removeChild(this.div),this.div=null};U.prototype.onAdd=function(){this.div=document.createElement("div"),this.div.style.position="absolute",this.div.id="GoogleClustrOverlay";var e=this.getPanes();e.overlayImage.appendChild(this.div)};U.prototype.draw=function(){var e=this.getProjection(),r=e.fromLatLngToDivPixel(this.map.getBounds().getSouthWest()),t=e.fromLatLngToDivPixel(this.map.getBounds().getNorthEast());this.div.style.left=r.x+"px",this.div.style.top=t.y+"px"};Le.exports=U});var xe=P((dr,ne)=>{"use strict";(function(){"use strict";function e(t){t.sort(function(p,d){return p.x!=d.x?p.x-d.x:p.y-d.y});for(var n=t.length,o=[],s=0;s<2*n;s++){for(var i=s<n?s:2*n-1-s;o.length>=2&&r(o[o.length-2],o[o.length-1],t[i]);)o.pop();o.push(t[i])}return o.pop(),o}function r(t,n,o){var s=(t.x-n.x)*(o.y-n.y)-(t.y-n.y)*(o.x-n.x),i=(t.x-n.x)*(o.x-n.x)+(t.y-n.y)*(o.y-n.y);return s<0||s==0&&i<=0}typeof define=="function"&&define.amd?define(function(){return e}):typeof ne<"u"?ne.exports=e:typeof self<"u"?self.convexHull=e:window.convexHull=e})()});var Ie=P((mr,De)=>{var Lt="Expected a function",Ce=NaN,kt="[object Symbol]",xt=/^\s+|\s+$/g,Ct=/^[-+]0x[0-9a-f]+$/i,wt=/^0b[01]+$/i,Dt=/^0o[0-7]+$/i,It=parseInt,_t=typeof global=="object"&&global&&global.Object===Object&&global,Ot=typeof self=="object"&&self&&self.Object===Object&&self,St=_t||Ot||Function("return this")(),Mt=Object.prototype,Pt=Mt.toString,Tt=Math.max,Et=Math.min,oe=function(){return St.Date.now()};function jt(e,r,t){var n,o,s,i,p,d,l=0,u=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(Lt);r=we(r)||0,ie(t)&&(u=!!t.leading,f="maxWait"in t,s=f?Tt(we(t.maxWait)||0,r):s,h="trailing"in t?!!t.trailing:h);function c(k){var w=n,R=o;return n=o=void 0,l=k,i=e.apply(R,w),i}function a(k){return l=k,p=setTimeout(v,r),u?c(k):i}function g(k){var w=k-d,R=k-l,q=r-w;return f?Et(q,s-R):q}function m(k){var w=k-d,R=k-l;return d===void 0||w>=r||w<0||f&&R>=s}function v(){var k=oe();if(m(k))return y(k);p=setTimeout(v,g(k))}function y(k){return p=void 0,h&&n?c(k):(n=o=void 0,i)}function b(){p!==void 0&&clearTimeout(p),l=0,n=d=o=p=void 0}function L(){return p===void 0?i:y(oe())}function x(){var k=oe(),w=m(k);if(n=arguments,o=this,d=k,w){if(p===void 0)return a(d);if(f)return p=setTimeout(v,r),c(d)}return p===void 0&&(p=setTimeout(v,r)),i}return x.cancel=b,x.flush=L,x}function ie(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function At(e){return!!e&&typeof e=="object"}function Rt(e){return typeof e=="symbol"||At(e)&&Pt.call(e)==kt}function we(e){if(typeof e=="number")return e;if(Rt(e))return Ce;if(ie(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=ie(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(xt,"");var t=wt.test(e);return t||Dt.test(e)?It(e.slice(2),t?2:8):Ct.test(e)?Ce:+e}De.exports=jt});function N(){if(!$&&($=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!$))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return $(Ht)}var $,Ht,se=M(()=>{Ht=new Uint8Array(16)});var _e,Oe=M(()=>{_e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function Bt(e){return typeof e=="string"&&_e.test(e)}var T,Z=M(()=>{Oe();T=Bt});function Ut(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(D[e[r+0]]+D[e[r+1]]+D[e[r+2]]+D[e[r+3]]+"-"+D[e[r+4]]+D[e[r+5]]+"-"+D[e[r+6]]+D[e[r+7]]+"-"+D[e[r+8]]+D[e[r+9]]+"-"+D[e[r+10]]+D[e[r+11]]+D[e[r+12]]+D[e[r+13]]+D[e[r+14]]+D[e[r+15]]).toLowerCase();if(!T(t))throw TypeError("Stringified UUID is invalid");return t}var D,K,E,F=M(()=>{Z();D=[];for(K=0;K<256;++K)D.push((K+256).toString(16).substr(1));E=Ut});function Nt(e,r,t){var n=r&&t||0,o=r||new Array(16);e=e||{};var s=e.node||Se,i=e.clockseq!==void 0?e.clockseq:ae;if(s==null||i==null){var p=e.random||(e.rng||N)();s==null&&(s=Se=[p[0]|1,p[1],p[2],p[3],p[4],p[5]]),i==null&&(i=ae=(p[6]<<8|p[7])&16383)}var d=e.msecs!==void 0?e.msecs:Date.now(),l=e.nsecs!==void 0?e.nsecs:ce+1,u=d-le+(l-ce)/1e4;if(u<0&&e.clockseq===void 0&&(i=i+1&16383),(u<0||d>le)&&e.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");le=d,ce=l,ae=i,d+=122192928e5;var f=((d&268435455)*1e4+l)%4294967296;o[n++]=f>>>24&255,o[n++]=f>>>16&255,o[n++]=f>>>8&255,o[n++]=f&255;var h=d/4294967296*1e4&268435455;o[n++]=h>>>8&255,o[n++]=h&255,o[n++]=h>>>24&15|16,o[n++]=h>>>16&255,o[n++]=i>>>8|128,o[n++]=i&255;for(var c=0;c<6;++c)o[n+c]=s[c];return r||E(o)}var Se,ae,le,ce,Me,Pe=M(()=>{se();F();le=0,ce=0;Me=Nt});function Zt(e){if(!T(e))throw TypeError("Invalid UUID");var r,t=new Uint8Array(16);return t[0]=(r=parseInt(e.slice(0,8),16))>>>24,t[1]=r>>>16&255,t[2]=r>>>8&255,t[3]=r&255,t[4]=(r=parseInt(e.slice(9,13),16))>>>8,t[5]=r&255,t[6]=(r=parseInt(e.slice(14,18),16))>>>8,t[7]=r&255,t[8]=(r=parseInt(e.slice(19,23),16))>>>8,t[9]=r&255,t[10]=(r=parseInt(e.slice(24,36),16))/1099511627776&255,t[11]=r/4294967296&255,t[12]=r>>>24&255,t[13]=r>>>16&255,t[14]=r>>>8&255,t[15]=r&255,t}var Q,fe=M(()=>{Z();Q=Zt});function Ft(e){e=unescape(encodeURIComponent(e));for(var r=[],t=0;t<e.length;++t)r.push(e.charCodeAt(t));return r}function Y(e,r,t){function n(o,s,i,p){if(typeof o=="string"&&(o=Ft(o)),typeof s=="string"&&(s=Q(s)),s.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var d=new Uint8Array(16+o.length);if(d.set(s),d.set(o,s.length),d=t(d),d[6]=d[6]&15|r,d[8]=d[8]&63|128,i){p=p||0;for(var l=0;l<16;++l)i[p+l]=d[l];return i}return E(d)}try{n.name=e}catch{}return n.DNS=Vt,n.URL=zt,n}var Vt,zt,ue=M(()=>{F();fe();Vt="6ba7b810-9dad-11d1-80b4-00c04fd430c8",zt="6ba7b811-9dad-11d1-80b4-00c04fd430c8"});function Wt(e){if(typeof e=="string"){var r=unescape(encodeURIComponent(e));e=new Uint8Array(r.length);for(var t=0;t<r.length;++t)e[t]=r.charCodeAt(t)}return qt(Gt(Xt(e),e.length*8))}function qt(e){for(var r=[],t=e.length*32,n="0123456789abcdef",o=0;o<t;o+=8){var s=e[o>>5]>>>o%32&255,i=parseInt(n.charAt(s>>>4&15)+n.charAt(s&15),16);r.push(i)}return r}function Te(e){return(e+64>>>9<<4)+14+1}function Gt(e,r){e[r>>5]|=128<<r%32,e[Te(r)-1]=r;for(var t=1732584193,n=-271733879,o=-1732584194,s=271733878,i=0;i<e.length;i+=16){var p=t,d=n,l=o,u=s;t=I(t,n,o,s,e[i],7,-680876936),s=I(s,t,n,o,e[i+1],12,-389564586),o=I(o,s,t,n,e[i+2],17,606105819),n=I(n,o,s,t,e[i+3],22,-1044525330),t=I(t,n,o,s,e[i+4],7,-176418897),s=I(s,t,n,o,e[i+5],12,1200080426),o=I(o,s,t,n,e[i+6],17,-1473231341),n=I(n,o,s,t,e[i+7],22,-45705983),t=I(t,n,o,s,e[i+8],7,1770035416),s=I(s,t,n,o,e[i+9],12,-1958414417),o=I(o,s,t,n,e[i+10],17,-42063),n=I(n,o,s,t,e[i+11],22,-1990404162),t=I(t,n,o,s,e[i+12],7,1804603682),s=I(s,t,n,o,e[i+13],12,-40341101),o=I(o,s,t,n,e[i+14],17,-1502002290),n=I(n,o,s,t,e[i+15],22,1236535329),t=_(t,n,o,s,e[i+1],5,-165796510),s=_(s,t,n,o,e[i+6],9,-1069501632),o=_(o,s,t,n,e[i+11],14,643717713),n=_(n,o,s,t,e[i],20,-373897302),t=_(t,n,o,s,e[i+5],5,-701558691),s=_(s,t,n,o,e[i+10],9,38016083),o=_(o,s,t,n,e[i+15],14,-660478335),n=_(n,o,s,t,e[i+4],20,-405537848),t=_(t,n,o,s,e[i+9],5,568446438),s=_(s,t,n,o,e[i+14],9,-1019803690),o=_(o,s,t,n,e[i+3],14,-187363961),n=_(n,o,s,t,e[i+8],20,1163531501),t=_(t,n,o,s,e[i+13],5,-1444681467),s=_(s,t,n,o,e[i+2],9,-51403784),o=_(o,s,t,n,e[i+7],14,1735328473),n=_(n,o,s,t,e[i+12],20,-1926607734),t=O(t,n,o,s,e[i+5],4,-378558),s=O(s,t,n,o,e[i+8],11,-2022574463),o=O(o,s,t,n,e[i+11],16,1839030562),n=O(n,o,s,t,e[i+14],23,-35309556),t=O(t,n,o,s,e[i+1],4,-1530992060),s=O(s,t,n,o,e[i+4],11,1272893353),o=O(o,s,t,n,e[i+7],16,-155497632),n=O(n,o,s,t,e[i+10],23,-1094730640),t=O(t,n,o,s,e[i+13],4,681279174),s=O(s,t,n,o,e[i],11,-358537222),o=O(o,s,t,n,e[i+3],16,-722521979),n=O(n,o,s,t,e[i+6],23,76029189),t=O(t,n,o,s,e[i+9],4,-640364487),s=O(s,t,n,o,e[i+12],11,-421815835),o=O(o,s,t,n,e[i+15],16,530742520),n=O(n,o,s,t,e[i+2],23,-995338651),t=S(t,n,o,s,e[i],6,-198630844),s=S(s,t,n,o,e[i+7],10,1126891415),o=S(o,s,t,n,e[i+14],15,-1416354905),n=S(n,o,s,t,e[i+5],21,-57434055),t=S(t,n,o,s,e[i+12],6,1700485571),s=S(s,t,n,o,e[i+3],10,-1894986606),o=S(o,s,t,n,e[i+10],15,-1051523),n=S(n,o,s,t,e[i+1],21,-2054922799),t=S(t,n,o,s,e[i+8],6,1873313359),s=S(s,t,n,o,e[i+15],10,-30611744),o=S(o,s,t,n,e[i+6],15,-1560198380),n=S(n,o,s,t,e[i+13],21,1309151649),t=S(t,n,o,s,e[i+4],6,-145523070),s=S(s,t,n,o,e[i+11],10,-1120210379),o=S(o,s,t,n,e[i+2],15,718787259),n=S(n,o,s,t,e[i+9],21,-343485551),t=j(t,p),n=j(n,d),o=j(o,l),s=j(s,u)}return[t,n,o,s]}function Xt(e){if(e.length===0)return[];for(var r=e.length*8,t=new Uint32Array(Te(r)),n=0;n<r;n+=8)t[n>>5]|=(e[n/8]&255)<<n%32;return t}function j(e,r){var t=(e&65535)+(r&65535),n=(e>>16)+(r>>16)+(t>>16);return n<<16|t&65535}function $t(e,r){return e<<r|e>>>32-r}function J(e,r,t,n,o,s){return j($t(j(j(r,e),j(n,s)),o),t)}function I(e,r,t,n,o,s,i){return J(r&t|~r&n,e,r,o,s,i)}function _(e,r,t,n,o,s,i){return J(r&n|t&~n,e,r,o,s,i)}function O(e,r,t,n,o,s,i){return J(r^t^n,e,r,o,s,i)}function S(e,r,t,n,o,s,i){return J(t^(r|~n),e,r,o,s,i)}var Ee,je=M(()=>{Ee=Wt});var Kt,Ae,Re=M(()=>{ue();je();Kt=Y("v3",48,Ee),Ae=Kt});function Qt(e,r,t){e=e||{};var n=e.random||(e.rng||N)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){t=t||0;for(var o=0;o<16;++o)r[t+o]=n[o];return r}return E(n)}var He,Be=M(()=>{se();F();He=Qt});function Yt(e,r,t,n){switch(e){case 0:return r&t^~r&n;case 1:return r^t^n;case 2:return r&t^r&n^t&n;case 3:return r^t^n}}function he(e,r){return e<<r|e>>>32-r}function Jt(e){var r=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){var n=unescape(encodeURIComponent(e));e=[];for(var o=0;o<n.length;++o)e.push(n.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var s=e.length/4+2,i=Math.ceil(s/16),p=new Array(i),d=0;d<i;++d){for(var l=new Uint32Array(16),u=0;u<16;++u)l[u]=e[d*64+u*4]<<24|e[d*64+u*4+1]<<16|e[d*64+u*4+2]<<8|e[d*64+u*4+3];p[d]=l}p[i-1][14]=(e.length-1)*8/Math.pow(2,32),p[i-1][14]=Math.floor(p[i-1][14]),p[i-1][15]=(e.length-1)*8&4294967295;for(var f=0;f<i;++f){for(var h=new Uint32Array(80),c=0;c<16;++c)h[c]=p[f][c];for(var a=16;a<80;++a)h[a]=he(h[a-3]^h[a-8]^h[a-14]^h[a-16],1);for(var g=t[0],m=t[1],v=t[2],y=t[3],b=t[4],L=0;L<80;++L){var x=Math.floor(L/20),k=he(g,5)+Yt(x,m,v,y)+b+r[x]+h[L]>>>0;b=y,y=v,v=he(m,30)>>>0,m=g,g=k}t[0]=t[0]+g>>>0,t[1]=t[1]+m>>>0,t[2]=t[2]+v>>>0,t[3]=t[3]+y>>>0,t[4]=t[4]+b>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var Ue,Ne=M(()=>{Ue=Jt});var er,Ze,Fe=M(()=>{ue();Ne();er=Y("v5",80,Ue),Ze=er});var Ve,ze=M(()=>{Ve="00000000-0000-0000-0000-000000000000"});function tr(e){if(!T(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}var We,qe=M(()=>{Z();We=tr});var Ge={};yt(Ge,{NIL:()=>Ve,parse:()=>Q,stringify:()=>E,v1:()=>Me,v3:()=>Ae,v4:()=>He,v5:()=>Ze,validate:()=>T,version:()=>We});var Xe=M(()=>{Pe();Re();Be();Fe();ze();qe();Z();F();fe()});var Ke=P((en,$e)=>{"use strict";function ge(e,r){if(!e||!r||!e.length||!r.length)throw new Error("Bad alphabet");this.srcAlphabet=e,this.dstAlphabet=r}ge.prototype.convert=function(e){var r,t,n,o={},s=this.srcAlphabet.length,i=this.dstAlphabet.length,p=e.length,d=typeof e=="string"?"":[];if(!this.isValid(e))throw new Error('Number "'+e+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return e;for(r=0;r<p;r++)o[r]=this.srcAlphabet.indexOf(e[r]);do{for(t=0,n=0,r=0;r<p;r++)t=t*s+o[r],t>=i?(o[n++]=parseInt(t/i,10),t=t%i):n>0&&(o[n++]=0);p=n,d=this.dstAlphabet.slice(t,t+1).concat(d)}while(n!==0);return d};ge.prototype.isValid=function(e){for(var r=0;r<e.length;++r)if(this.srcAlphabet.indexOf(e[r])===-1)return!1;return!0};$e.exports=ge});var Ye=P((tn,Qe)=>{var rr=Ke();function V(e,r){var t=new rr(e,r);return function(n){return t.convert(n)}}V.BIN="01";V.OCT="01234567";V.DEC="0123456789";V.HEX="0123456789abcdef";Qe.exports=V});var tt=P((rn,et)=>{var{v4:pe}=(Xe(),bt(Ge)),ee=Ye(),de="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ",nr="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&'()*+-./:<=>?@[]^_`{|}~",or={consistentLength:!0},me,Je=(e,r,t)=>{let n=r(e.toLowerCase().replace(/-/g,""));return!t||!t.consistentLength?n:n.padStart(t.shortIdLength,t.paddingChar)},ir=(e,r)=>{let n=r(e).padStart(32,"0").match(/(\w{8})(\w{4})(\w{4})(\w{4})(\w{12})/);return[n[1],n[2],n[3],n[4],n[5]].join("-")},sr=e=>Math.ceil(Math.log(2**128)/Math.log(e));et.exports=(()=>{let e=(r,t)=>{let n=r||de,o={...or,...t};if([...new Set(Array.from(n))].length!==n.length)throw new Error("The provided Alphabet has duplicate characters resulting in unreliable results");let s=sr(n.length),i={shortIdLength:s,consistentLength:o.consistentLength,paddingChar:n[0]},p=ee(ee.HEX,n),d=ee(n,ee.HEX),l=()=>Je(pe(),p,i),u={new:l,generate:l,uuid:pe,fromUUID:f=>Je(f,p,i),toUUID:f=>ir(f,d),alphabet:n,maxLength:s};return Object.freeze(u),u};return e.constants={flickrBase58:de,cookieBase90:nr},e.uuid=pe,e.generate=()=>(me||(me=e(de).generate),me()),e})()});var ot=P((nn,nt)=>{"use strict";function rt(e,r){function t(){}t.prototype=r.prototype,e.superClass_=r.prototype,e.prototype=new t,e.prototype.constructor=e}function C(e,r,t,n){this.marker_=r,this.handCursorURL_=r.handCursorURL,this.labelDiv_=document.createElement("div"),typeof e<"u"&&(this.labelDiv_.id=e),this.labelDiv_.style.cssText="position: absolute; overflow: hidden;",this.crossDiv_=C.getSharedCross(t)}rt(C,google.maps.OverlayView);C.getSharedCross=function(e){var r;return typeof C.getSharedCross.crossDiv>"u"&&(r=document.createElement("img"),r.style.cssText="position: absolute; z-index: 1000002; display: none;",r.style.marginLeft="-8px",r.style.marginTop="-9px",r.src=e,C.getSharedCross.crossDiv=r),C.getSharedCross.crossDiv};C.prototype.onAdd=function(){var e=this,r=!1,t=!1,n,o,s,i,p,d,l,u=20,f="url("+this.handCursorURL_+")",h=function(a){a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},c=function(){e.marker_.setAnimation(null)};this.getPanes().overlayMouseTarget.appendChild(this.labelDiv_),typeof C.getSharedCross.processed>"u"&&(this.getPanes().overlayMouseTarget.appendChild(this.crossDiv_),C.getSharedCross.processed=!0),this.listeners_=[google.maps.event.addDomListener(this.labelDiv_,"mouseover",function(a){(e.marker_.getDraggable()||e.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(e.marker_,"mouseover",a))}),google.maps.event.addDomListener(this.labelDiv_,"mouseout",function(a){(e.marker_.getDraggable()||e.marker_.getClickable())&&!t&&(this.style.cursor=e.marker_.getCursor(),google.maps.event.trigger(e.marker_,"mouseout",a))}),google.maps.event.addDomListener(this.labelDiv_,"mousedown",function(a){t=!1,e.marker_.getDraggable()&&(r=!0,this.style.cursor=f),(e.marker_.getDraggable()||e.marker_.getClickable())&&(google.maps.event.trigger(e.marker_,"mousedown",a),h(a))}),google.maps.event.addDomListener(document,"mouseup",function(a){var g;if(r&&(r=!1,e.eventDiv_.style.cursor="pointer",google.maps.event.trigger(e.marker_,"mouseup",a)),t){if(p){g=e.getProjection().fromLatLngToDivPixel(e.marker_.getPosition()),g.y+=u,e.marker_.setPosition(e.getProjection().fromDivPixelToLatLng(g));try{e.marker_.setAnimation(google.maps.Animation.BOUNCE),setTimeout(c,1406)}catch{}}e.crossDiv_.style.display="none",e.marker_.setZIndex(n),i=!0,t=!1,a.latLng=e.marker_.getPosition(),google.maps.event.trigger(e.marker_,"dragend",a)}}),google.maps.event.addListener(e.marker_.getMap(),"mousemove",function(a){var g;r&&(t?(a.latLng=new google.maps.LatLng(a.latLng.lat()-o,a.latLng.lng()-s),g=e.getProjection().fromLatLngToDivPixel(a.latLng),p&&(e.crossDiv_.style.left=g.x+"px",e.crossDiv_.style.top=g.y+"px",e.crossDiv_.style.display="",g.y-=u),e.marker_.setPosition(e.getProjection().fromDivPixelToLatLng(g)),p&&(e.eventDiv_.style.top=g.y+u+"px"),google.maps.event.trigger(e.marker_,"drag",a)):(o=a.latLng.lat()-e.marker_.getPosition().lat(),s=a.latLng.lng()-e.marker_.getPosition().lng(),n=e.marker_.getZIndex(),d=e.marker_.getPosition(),l=e.marker_.getMap().getCenter(),p=e.marker_.get("raiseOnDrag"),t=!0,e.marker_.setZIndex(1e6),a.latLng=e.marker_.getPosition(),google.maps.event.trigger(e.marker_,"dragstart",a)))}),google.maps.event.addDomListener(document,"keydown",function(a){t&&a.keyCode===27&&(p=!1,e.marker_.setPosition(d),e.marker_.getMap().setCenter(l),google.maps.event.trigger(document,"mouseup",a))}),google.maps.event.addDomListener(this.labelDiv_,"click",function(a){(e.marker_.getDraggable()||e.marker_.getClickable())&&(i?i=!1:(google.maps.event.trigger(e.marker_,"click",a),h(a)))}),google.maps.event.addDomListener(this.labelDiv_,"dblclick",function(a){(e.marker_.getDraggable()||e.marker_.getClickable())&&(google.maps.event.trigger(e.marker_,"dblclick",a),h(a))}),google.maps.event.addListener(this.marker_,"dragstart",function(a){t||(p=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(a){t||p&&(e.setPosition(u),e.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(a){t||p&&e.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){e.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){e.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){e.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){e.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){e.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){e.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){e.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){e.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){e.setStyles()})]};C.prototype.onRemove=function(){var e;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),e=0;e<this.listeners_.length;e++)google.maps.event.removeListener(this.listeners_[e])};C.prototype.draw=function(){this.setContent(),this.setTitle(),this.setStyles(),this.setDataSet()};C.prototype.setContent=function(){var e=this.marker_.get("labelContent");typeof e.nodeType>"u"?this.labelDiv_.innerHTML=e:(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(e))};C.prototype.setDataSet=function(){this.marker_.get("data").forEach((r,t)=>{this.labelDiv_.dataset[Object.keys(r)[0]]=r[Object.keys(r)[0]]})};C.prototype.setTitle=function(){this.labelDiv_.title=this.marker_.getTitle()||""};C.prototype.setStyles=function(){var e,r;this.labelDiv_.className=this.marker_.get("labelClass"),this.labelDiv_.style.cssText="",r=this.marker_.get("labelStyle");for(e in r)r.hasOwnProperty(e)&&(this.labelDiv_.style[e]=r[e]);this.setMandatoryStyles()};C.prototype.setMandatoryStyles=function(){this.labelDiv_.style.position="absolute",this.labelDiv_.style.overflow="hidden",typeof this.labelDiv_.style.opacity<"u"&&this.labelDiv_.style.opacity!==""&&(this.labelDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity='+this.labelDiv_.style.opacity*100+')"',this.labelDiv_.style.filter="alpha(opacity="+this.labelDiv_.style.opacity*100+")"),this.setAnchor(),this.setPosition(),this.setVisible()};C.prototype.setAnchor=function(){var e=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-e.x+"px",this.labelDiv_.style.marginTop=-e.y+"px"};C.prototype.setPosition=function(e){var r=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());typeof e>"u"&&(e=0),this.labelDiv_.style.left=Math.round(r.x)+"px",this.labelDiv_.style.top=Math.round(r.y-e)+"px",this.setZIndex()};C.prototype.setZIndex=function(){var e=this.marker_.get("labelInBackground")?-1:1;typeof this.marker_.getZIndex()>"u"?this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+e:this.labelDiv_.style.zIndex=this.marker_.getZIndex()+e};C.prototype.setVisible=function(){this.marker_.get("labelVisible")?this.labelDiv_.style.display=this.marker_.getVisible()?"block":"none":this.labelDiv_.style.display="none"};function ve(e){e=e||{},e.labelContent=e.labelContent||"",e.labelAnchor=e.labelAnchor||new google.maps.Point(0,0),e.labelClass=e.labelClass||"markerLabels",e.labelStyle=e.labelStyle||{},e.labelInBackground=e.labelInBackground||!1,typeof e.labelVisible>"u"&&(e.labelVisible=!0),typeof e.raiseOnDrag>"u"&&(e.raiseOnDrag=!0),typeof e.clickable>"u"&&(e.clickable=!0),typeof e.draggable>"u"&&(e.draggable=!1),typeof e.optimized>"u"&&(e.optimized=!1),e.crossImage=e.crossImage||"http"+(document.location.protocol==="https:"?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png",e.handCursor=e.handCursor||"http"+(document.location.protocol==="https:"?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur",e.optimized=!1,this.label=new C(e.id,this,e.crossImage,e.handCursor),google.maps.Marker.apply(this,arguments)}rt(ve,google.maps.Marker);ve.prototype.setMap=function(e){google.maps.Marker.prototype.setMap.apply(this,arguments),this.label.setMap(e)};nt.exports=ve});var st=P((on,it)=>{"use strict";var ar={}.hasOwnProperty,lr=[].slice,cr=function(){function e(l,u){var f,h,c,a;this.map=l,u==null&&(u={});for(f in u)ar.call(u,f)&&(h=u[f],this[f]=h);for(this.e=new this.constructor.g(this.map),this.n(),this.b={},a=["click","zoom_changed","maptypeid_changed"],h=0,c=a.length;h<c;h++)f=a[h],r.addListener(this.map,f,function(g){return function(){return g.unspiderfy()}}(this))}var r,t,n,o,s,i,p,d;for(i=e.prototype,d=[e,i],o=0,s=d.length;o<s;o++)n=d[o],n.VERSION="0.3.3";return t=google.maps,r=t.event,s=t.MapTypeId,p=2*Math.PI,i.keepSpiderfied=!1,i.markersWontHide=!1,i.markersWontMove=!1,i.nearbyDistance=20,i.circleSpiralSwitchover=9,i.circleFootSeparation=23,i.circleStartAngle=p/12,i.spiralFootSeparation=26,i.spiralLengthStart=11,i.spiralLengthFactor=4,i.spiderfiedZIndex=1e3,i.usualLegZIndex=10,i.highlightedLegZIndex=20,i.event="click",i.minZoomLevel=!1,i.legWeight=1.5,i.legColors={usual:{},highlighted:{}},o=i.legColors.usual,n=i.legColors.highlighted,o[s.HYBRID]=o[s.SATELLITE]="#fff",n[s.HYBRID]=n[s.SATELLITE]="#f00",o[s.TERRAIN]=o[s.ROADMAP]="#444",n[s.TERRAIN]=n[s.ROADMAP]="#f00",i.n=function(){this.a=[],this.j=[]},i.addMarker=function(l){var u;return l._oms!=null?this:(l._oms=!0,u=[r.addListener(l,this.event,function(f){return function(h){return f.G(l,h)}}(this))],this.markersWontHide||u.push(r.addListener(l,"visible_changed",function(f){return function(){return f.o(l,!1)}}(this))),this.markersWontMove||u.push(r.addListener(l,"position_changed",function(f){return function(){return f.o(l,!0)}}(this))),this.j.push(u),this.a.push(l),this)},i.o=function(l,u){if(l._omsData!=null&&(u||!l.getVisible())&&this.s==null&&this.t==null)return this.unspiderfy(u?l:null)},i.getMarkers=function(){return this.a.slice(0)},i.removeMarker=function(l){var u,f,h,c,a;if(l._omsData!=null&&this.unspiderfy(),u=this.m(this.a,l),0>u)return this;for(h=this.j.splice(u,1)[0],c=0,a=h.length;c<a;c++)f=h[c],r.removeListener(f);return delete l._oms,this.a.splice(u,1),this},i.clearMarkers=function(){var l,u,f,h,c,a,g,m;for(this.unspiderfy(),m=this.a,l=h=0,a=m.length;h<a;l=++h){for(f=m[l],u=this.j[l],c=0,g=u.length;c<g;c++)l=u[c],r.removeListener(l);delete f._oms}return this.n(),this},i.addListener=function(l,u){var f;return((f=this.b)[l]!=null?f[l]:f[l]=[]).push(u),this},i.removeListener=function(l,u){var f;return f=this.m(this.b[l],u),0>f||this.b[l].splice(f,1),this},i.clearListeners=function(l){return this.b[l]=[],this},i.trigger=function(){var l,u,f,h,c,a;for(u=arguments[0],l=2<=arguments.length?lr.call(arguments,1):[],u=(f=this.b[u])!=null?f:[],a=[],h=0,c=u.length;h<c;h++)f=u[h],a.push(f.apply(null,l));return a},i.u=function(l,u){var f,h,c,a,g;for(c=this.circleFootSeparation*(2+l)/p,h=p/l,g=[],f=a=0;0<=l?a<l:a>l;f=0<=l?++a:--a)f=this.circleStartAngle+f*h,g.push(new t.Point(u.x+c*Math.cos(f),u.y+c*Math.sin(f)));return g},i.v=function(l,u){var f,h,c,a,g;for(c=this.spiralLengthStart,f=0,g=[],h=a=0;0<=l?a<l:a>l;h=0<=l?++a:--a)f+=this.spiralFootSeparation/c+5e-4*h,h=new t.Point(u.x+c*Math.cos(f),u.y+c*Math.sin(f)),c+=p*this.spiralLengthFactor/f,g.push(h);return g},i.G=function(l,u){var f,h,c,a,g,m,v,y,b,L;if(m=l._omsData!=null,m&&this.keepSpiderfied||(this.event==="mouseover"?(f=this,h=function(){return f.unspiderfy()},window.clearTimeout(i.timeout),i.timeout=setTimeout(h,3e3)):this.unspiderfy()),m||this.map.getStreetView().getVisible()||this.map.getMapTypeId()==="GoogleEarthAPI")return this.trigger("click",l,u);for(h=[],m=[],c=this.nearbyDistance,v=c*c,g=this.c(l.position),L=this.a,y=0,b=L.length;y<b;y++)c=L[y],c.map!=null&&c.getVisible()&&(a=this.c(c.position),this.f(a,g)<v?h.push({B:c,p:a}):m.push(c));return h.length===1?this.trigger("click",l,u):this.H(h,m)},i.markersNearMarker=function(l,u){var f,h,c,a,g,m,v,y,b,L;if(u==null&&(u=!1),this.e.getProjection()==null)throw"Must wait for 'idle' event on map before calling markersNearMarker";for(f=this.nearbyDistance,g=f*f,c=this.c(l.position),a=[],y=this.a,m=0,v=y.length;m<v&&(f=y[m],!(f!==l&&f.map!=null&&f.getVisible()&&(h=this.c((b=(L=f._omsData)!=null?L.l:void 0)!=null?b:f.position),this.f(h,c)<g&&(a.push(f),u))));m++);return a},i.markersNearAnyOtherMarker=function(){var l,u,f,h,c,a,g,m,v,y,b,L;if(this.e.getProjection()==null)throw"Must wait for 'idle' event on map before calling markersNearAnyOtherMarker";for(a=this.nearbyDistance,l=a*a,h=this.a,a=[],b=0,f=h.length;b<f;b++)u=h[b],a.push({q:this.c((g=(v=u._omsData)!=null?v.l:void 0)!=null?g:u.position),d:!1});for(b=this.a,u=g=0,v=b.length;g<v;u=++g)if(f=b[u],f.map!=null&&f.getVisible()&&(h=a[u],!h.d)){for(L=this.a,f=m=0,y=L.length;m<y;f=++m)if(c=L[f],f!==u&&c.map!=null&&c.getVisible()&&(c=a[f],(!(f<u)||c.d)&&this.f(h.q,c.q)<l)){h.d=c.d=!0;break}}for(b=this.a,f=[],l=g=0,v=b.length;g<v;l=++g)u=b[l],a[l].d&&f.push(u);return f},i.A=function(l){return{h:function(u){return function(){return l._omsData.i.setOptions({strokeColor:u.legColors.highlighted[u.map.mapTypeId],zIndex:u.highlightedLegZIndex})}}(this),k:function(u){return function(){return l._omsData.i.setOptions({strokeColor:u.legColors.usual[u.map.mapTypeId],zIndex:u.usualLegZIndex})}}(this)}},i.H=function(l,u){var f,h,c,a,g,m,v,y,b,L;return this.minZoomLevel&&this.map.getZoom()<this.minZoomLevel?!1:(this.s=!0,L=l.length,f=this.D(function(){var x,k,w;for(w=[],x=0,k=l.length;x<k;x++)y=l[x],w.push(y.p);return w}()),a=L>=this.circleSpiralSwitchover?this.v(L,f).reverse():this.u(L,f),f=function(){var x,k,w;for(w=[],x=0,k=a.length;x<k;x++)c=a[x],h=this.F(c),b=this.C(l,function(R){return function(q){return R.f(q.p,c)}}(this)),v=b.B,m=new t.Polyline({map:this.map,path:[v.position,h],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex}),v._omsData={l:v.position,i:m},this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId]&&(g=this.A(v),v._omsData.w={h:r.addListener(v,"mouseover",g.h),k:r.addListener(v,"mouseout",g.k)}),v.setPosition(h),v.setZIndex(Math.round(this.spiderfiedZIndex+c.y)),w.push(v);return w}.call(this),delete this.s,this.r=!0,this.trigger("spiderfy",f,u))},i.unspiderfy=function(l){var u,f,h,c,a,g,m;if(l==null&&(l=null),this.r==null)return this;for(this.t=!0,c=[],h=[],m=this.a,a=0,g=m.length;a<g;a++)f=m[a],f._omsData!=null?(f._omsData.i.setMap(null),f!==l&&f.setPosition(f._omsData.l),f.setZIndex(null),u=f._omsData.w,u!=null&&(r.removeListener(u.h),r.removeListener(u.k)),delete f._omsData,c.push(f)):h.push(f);return delete this.t,delete this.r,this.trigger("unspiderfy",c,h),this},i.f=function(l,u){var f,h;return f=l.x-u.x,h=l.y-u.y,f*f+h*h},i.D=function(l){var u,f,h,c,a;for(c=f=h=0,a=l.length;c<a;c++)u=l[c],f+=u.x,h+=u.y;return l=l.length,new t.Point(f/l,h/l)},i.c=function(l){return this.e.getProjection().fromLatLngToDivPixel(l)},i.F=function(l){return this.e.getProjection().fromDivPixelToLatLng(l)},i.C=function(l,u){var f,h,c,a,g,m;for(c=g=0,m=l.length;g<m;c=++g)a=l[c],a=u(a),(typeof f>"u"||f===null||a<h)&&(h=a,f=c);return l.splice(f,1)[0]},i.m=function(l,u){var f,h,c,a;if(l.indexOf!=null)return l.indexOf(u);for(f=c=0,a=l.length;c<a;f=++c)if(h=l[f],h===u)return f;return-1},e.g=function(l){return this.setMap(l)},e.g.prototype=new t.OverlayView,e.g.prototype.draw=function(){},e}();it.exports=cr});var ft=P((B,z)=>{(function(e,r){"use strict";var t={};e.PubSub?(t=e.PubSub,console.warn("PubSub already loaded, using existing version")):(e.PubSub=t,r(t)),typeof B=="object"?(z!==void 0&&z.exports&&(B=z.exports=t),B.PubSub=t,z.exports=B=t):typeof define=="function"&&define.amd&&define(function(){return t})})(typeof window=="object"&&window||B,function(e){"use strict";var r={},t=-1,n="*";function o(c){var a;for(a in c)if(Object.prototype.hasOwnProperty.call(c,a))return!0;return!1}function s(c){return function(){throw c}}function i(c,a,g){try{c(a,g)}catch(m){setTimeout(s(m),0)}}function p(c,a,g){c(a,g)}function d(c,a,g,m){var v=r[a],y=m?p:i,b;if(!!Object.prototype.hasOwnProperty.call(r,a))for(b in v)Object.prototype.hasOwnProperty.call(v,b)&&y(v[b],c,g)}function l(c,a,g){return function(){var v=String(c),y=v.lastIndexOf(".");for(d(c,c,a,g);y!==-1;)v=v.substr(0,y),y=v.lastIndexOf("."),d(c,v,a,g);d(c,n,a,g)}}function u(c){var a=String(c),g=Boolean(Object.prototype.hasOwnProperty.call(r,a)&&o(r[a]));return g}function f(c){for(var a=String(c),g=u(a)||u(n),m=a.lastIndexOf(".");!g&&m!==-1;)a=a.substr(0,m),m=a.lastIndexOf("."),g=u(a);return g}function h(c,a,g,m){c=typeof c=="symbol"?c.toString():c;var v=l(c,a,m),y=f(c);return y?(g===!0?v():setTimeout(v,0),!0):!1}e.publish=function(c,a){return h(c,a,!1,e.immediateExceptions)},e.publishSync=function(c,a){return h(c,a,!0,e.immediateExceptions)},e.subscribe=function(c,a){if(typeof a!="function")return!1;c=typeof c=="symbol"?c.toString():c,Object.prototype.hasOwnProperty.call(r,c)||(r[c]={});var g="uid_"+String(++t);return r[c][g]=a,g},e.subscribeAll=function(c){return e.subscribe(n,c)},e.subscribeOnce=function(c,a){var g=e.subscribe(c,function(){e.unsubscribe(g),a.apply(this,arguments)});return e},e.clearAllSubscriptions=function(){r={}},e.clearSubscriptions=function(a){var g;for(g in r)Object.prototype.hasOwnProperty.call(r,g)&&g.indexOf(a)===0&&delete r[g]},e.countSubscriptions=function(a){var g,m,v=0;for(g in r)if(Object.prototype.hasOwnProperty.call(r,g)&&g.indexOf(a)===0){for(m in r[g])v++;break}return v},e.getSubscriptions=function(a){var g,m=[];for(g in r)Object.prototype.hasOwnProperty.call(r,g)&&g.indexOf(a)===0&&m.push(g);return m},e.unsubscribe=function(c){var a=function(k){var w;for(w in r)if(Object.prototype.hasOwnProperty.call(r,w)&&w.indexOf(k)===0)return!0;return!1},g=typeof c=="string"&&(Object.prototype.hasOwnProperty.call(r,c)||a(c)),m=!g&&typeof c=="string",v=typeof c=="function",y=!1,b,L,x;if(g){e.clearSubscriptions(c);return}for(b in r)if(Object.prototype.hasOwnProperty.call(r,b)){if(L=r[b],m&&L[c]){delete L[c],y=c;break}if(v)for(x in L)Object.prototype.hasOwnProperty.call(L,x)&&L[x]===c&&(delete L[x],y=!0)}return y}})});var ht=H(ke());var X=class{constructor(){}clone(r){let t={}.toString.apply(r)=="[object Array]"?[]:{};for(let n in r)t[n]=typeof r[n]=="object"?this.clone(r[n]):r[n];return t}returnClusterClassObject(r){let t,n;return r>=3?(t="large",n=25):r===2?(t="medium",n=20):(t="small",n=15),{classSize:t,offSet:n}}returnMapProjections(r){let t=new google.maps.LatLngBounds,n=r.getProjection();return{bounds:t,projection:n,topRight:n.fromLatLngToPoint(r.getBounds().getNorthEast()),bottomLeft:n.fromLatLngToPoint(r.getBounds().getSouthWest()),scale:Math.pow(2,r.getZoom())}}returnPointsRaw(r,t){let n=this.returnMapProjections(r);return this.pointsRawLatLng=[],t.map(function(o,s){let i=n.projection.fromLatLngToPoint(new google.maps.LatLng(o.lat,o.lng)),p=(i.x-n.bottomLeft.x)*n.scale,d=(i.y-n.topRight.y)*n.scale;return[p,d,s]})}getCenterPoints(r,t,n){let o=[];for(let s=0;s<=document.getElementById(t).offsetWidth;s+=n)for(let i=0;i<=document.getElementById(t).offsetHeight;i+=n){let p=this.searchQuadTree(r,s,i,s+n,i+n),d=p.reduce(function(l,u){return[l[0]+u[0],l[1]+u[1]]},[0,0]);d[0]=d[0]/p.length,d[1]=d[1]/p.length,d.push(p),d[0]&&d[1]&&o.push(d)}return o}searchQuadTree(r,t,n,o,s){let i=[];return r.visit(function(p,d,l,u,f){let h=p.point;return h&&(h.selected=h[0]>=t&&h[0]<o&&h[1]>=n&&h[1]<s,h.selected&&i.push(h)),d>=o||l>=s||u<t||f<n}),i}async getScript(r,t){var n=document.createElement("script"),o=document.getElementsByTagName("script")[0];n.async=1,n.onload=n.onreadystatechange=function(s,i){(i||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n=void 0,!i&&t&&setTimeout(t,0))},n.src=r,o.parentNode.insertBefore(n,o)}};var ye=H(xe());var te=H(Ie()),at=H(tt()),lt=H(ot()),ct=H(st()),re=class{constructor(r,t){this.map=r,this.markers=[],this.markerListeners=[],this.collection=t,this.oms=new ct.default(this.map,{markersWontMove:!0,markersWontHide:!0,nearbyDistance:10,keepSpiderfied:!0,legWeight:3,usualLegZIndex:25e3})}print(){this.collection.forEach((r,t)=>{let n=r.lat||r.location.latitude,o=r.lng||r.location.longitude,s=new lt.default({id:`marker-${at.default.generate()}`,position:new google.maps.LatLng(n,o),map:self.map,icon:{path:google.maps.SymbolPath.CIRCLE,scale:0},draggable:!1,labelAnchor:new google.maps.Point(10,10),labelClass:"marker-point",data:r.dataset});this.markers.push(s),this.oms.addMarker(s),this.setOmsEvents(),this.setHoverEvents(!1)})}publishEvent=(0,te.default)((r,t)=>{GcPs.publish(r,t)},250,{leading:!0,trailing:!1});setOmsEvents(){let r=this;this.oms.addListener("spiderfy",function(t){r.publishEvent("spiderfy",t),r.removeUniversalPointHoverState(),r.markers.forEach(function(n){n.setOptions({zIndex:1e3,labelClass:n.labelClass+" fadePins"})}),t.forEach(function(n){r.removeListeners(),r.setHoverEvents(!0),n.setOptions({zIndex:2e4,labelClass:n.labelClass.replace(" fadePins","")})})}),this.oms.addListener("unspiderfy",function(t,n){r.publishEvent("unspiderfy",t),r.removeUniversalPointHoverState(),r.markers.forEach(function(o){o.setOptions({zIndex:1e3,labelClass:o.labelClass.replace(" fadePins","")})}),r.removeListeners(),r.setHoverEvents(!1)})}setHoverEvents=(0,te.default)((r=!1)=>{let t=this;this.setClickEvents(),this.markers.forEach(function(n){let o=n.addListener("mouseover",function({target:i}){GcPs.publish("hover",i),n.setOptions({zIndex:1e4,labelClass:this.labelClass+" PointHoverState"}),r||this.setZIndex(5e3)}),s=n.addListener("mouseout",function(){n.setOptions({zIndex:100,labelClass:this.labelClass.replace(" PointHoverState","")}),r||this.setZIndex(1e3)});t.markerListeners.push(o),t.markerListeners.push(s)})},250);setClickEvents=(0,te.default)(()=>{let r=this;this.markers.forEach(function(t){let n=t.addListener("click",function({target:o}){GcPs.publish("click",o)});r.markerListeners.push(n)})},250);removeUniversalPointHoverState(){this.markers.forEach((r,t)=>{r.setOptions({zIndex:100,labelClass:"marker-point"})})}removeListeners(){for(let r=0;r<this.markerListeners.length;r++)google.maps.event.removeListener(this.markerListeners[r]);this.markerListeners=[]}remove(){this.removeListeners();for(var r=0;r<this.markers.length;r++)this.markers[r].setMap(null)}};var W=H(ft()),A=new X;window.GcPs=W.default;var ut=class{map;collection;mapContainer="map";clusterRange=200;threshold=200;clusterRgba="34, 34, 34, 1";clusterBorder="5px solid #ccc";clusterFontColor="#FBBDC7";polygonStrokeColor="#222";polygonStrokeOpacity="0.5";polygonStrokeWeight="4";polygonFillColor="#222";polygonFillOpacity="0.3";overlay;mapContainerElem;points;polygon;helpers;constructor(r){A.getScript("https://d3js.org/d3.v3.min.js");for(let t in r)this[t]=r[t];this.createOverlay(),this.setMapEvents()}setMapEvents(){google.maps.event.addListener(this.map,"idle",()=>{this.collection&&(this.createOverlay(),this.removePolygon(),this.removeElements(),this.print())}),google.maps.event.addListener(this.map,"dragstart",()=>{this.removePolygon(),this.removeElements()}),google.maps.event.addListener(this.map,"zoom_changed",()=>{this.removePolygon(),this.removeElements()})}setCollection(r){this.collection=r;let t=setInterval(()=>{window.d3&&(clearInterval(t),this.print())},10)}createOverlay(){this.overlay&&this.overlay.setMap(null),this.overlay=new ht.default(this.map),this.overlay.setMap(this.map)}print(){let r=window.d3.geom.quadtree()(A.returnPointsRaw(this.map,this.collection)),t=A.getCenterPoints(r,this.mapContainer,this.clusterRange);this.points&&this.points.remove();let n=setInterval(()=>{this.mapContainerElem=document.querySelector("#GoogleClustrOverlay"),this.mapContainerElem&&(clearInterval(n),this.paint(t))},10)}removeElements(){for(var r=document.getElementsByClassName("point-cluster");r.length>0;)r[0]?.parentNode?.removeChild(r[0])}paint(r){this.checkIfLatLngInBounds().length<=this.threshold?(this.overlay.setMap(null),this.points=new re(this.map,this.checkIfLatLngInBounds()),this.points.print(),W.default.publish("count",this.points.collection.length),W.default.publish("show",this.points.collection)):(this.paintClustersToCanvas(r),W.default.publish("count",this.checkIfLatLngInBounds().length))}paintClustersToCanvas(r){let t=document.createDocumentFragment();for(let n=0;n<r.length;n++){let o=r[n][2].length,s=o.toString().length,i=document.createElement("div");i.className="point-cluster "+A.returnClusterClassObject(s).classSize,i.style.backgroundColor="rgba("+this.clusterRgba+")",i.style.color=this.clusterFontColor,i.dataset.positionid=n.toString();let p=[];for(let a=0;a<r[n][2].length;a++)p.push(r[n][2][a][2]);let d=[],l,u=A.returnMapProjections(this.map);for(let a=0;a<p.length;a++){let g=this.collection[p[a]];d.push(new google.maps.LatLng(g.lat,g.lng))}for(l=0;l<d.length;l++)u.bounds.extend(d[l]);let f=u.projection.fromLatLngToPoint(new google.maps.LatLng(u.bounds.getCenter().lat(),u.bounds.getCenter().lng())),h=(f.x-u.bottomLeft.x)*u.scale,c=(f.y-u.topRight.y)*u.scale;i.style.left=h-A.returnClusterClassObject(s).offSet+"px",i.style.top=c-A.returnClusterClassObject(s).offSet+"px",i.dataset.latlngids=p.join(","),i.innerHTML=o.toString(),t.appendChild(i),this.setClusterEvents(i)}this.mapContainerElem.appendChild(t)}setClusterEvents(r){r.onmouseover=()=>{this.showPolygon(r,this.collection,this.map)},r.onmouseout=()=>{this.removePolygon()},r.onclick=()=>{this.zoomToFit(r)}}zoomToFit(r){let t=r?.dataset?.latlngids?.split(","),n=[],o=[];t?.forEach((p,d)=>{var l=this.collection[parseInt(p)];o.push({x:l.lat,y:l.lng})}),o=(0,ye.default)(o),o.forEach(function(p,d){n.push(new google.maps.LatLng(p.x,p.y))});let s=new google.maps.LatLngBounds;for(var i=0;i<n.length;i++)s.extend(n[i]);requestAnimationFrame(()=>{let p=s.getCenter().lat(),d=s.getCenter().lng(),l=this.map.getZoom();this.map.setCenter(new google.maps.LatLng(p,d)),this.map.setZoom(this.getBoundsZoomLevel(s))})}getBoundsZoomLevel(r){let t={height:256,width:256},n=22,o=document.querySelector(`#${this.mapContainer}`),s={height:o.clientHeight,width:o.clientWidth};function i(g){let m=Math.sin(g*Math.PI/180),v=Math.log((1+m)/(1-m))/2;return Math.max(Math.min(v,Math.PI),-Math.PI)/2}function p(g,m,v){return Math.floor(Math.log(g/m/v)/Math.LN2)}let d=r.getNorthEast(),l=r.getSouthWest(),u=(i(d.lat())-i(l.lat()))/Math.PI,f=d.lng()-l.lng(),h=(f<0?f+360:f)/360,c=p(s.height,t.height,u),a=p(s.width,t.width,h);return Math.min(c,a,n)}checkIfLatLngInBounds(){let r=this,t=A.clone(this.collection);for(let n=0;n<t.length;++n){let o=t[n].lat||t[n].location.latitude,s=t[n].lng||t[n].location.longitude;r.map.getBounds().contains(new google.maps.LatLng(o,s))||(t.splice(n,1),--n)}return t}showPolygon(r,t,n){var o=r?.dataset?.latlngids?.split(",");o.push(o[0]);var s=[];for(let i=0;i<o.length;i++){let p=t[o[i]];s.push({x:p.lat,y:p.lng})}s=(0,ye.default)(s),s=s.map(i=>({lat:i.x,lng:i.y})),this.polygon=new google.maps.Polygon({paths:s,strokeColor:this.polygonStrokeColor,strokeOpacity:this.polygonStrokeOpacity,strokeWeight:this.polygonStrokeWeight,fillColor:this.polygonFillColor,fillOpacity:this.polygonFillOpacity}),this.polygon.setMap(n)}removePolygon(){this.polygon&&this.polygon.setMap(null)}};export{ut as GoogleClustr};
/*!
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//# sourceMappingURL=index.js.map
